<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><style>body{color:#fff;font-family:Arial,sans-serif;text-align:center;margin-top:60px}#timer{font-size:46px;margin-bottom:20px}#hitLine.flash{background:#0f8;box-shadow:0 0 20px #0f8}#timingUI.pulse{box-shadow:inset 0 0 40px rgba(0,255,120,.4)}.perfect{background:rgba(0,255,120,.6)}.good{background:rgba(255,200,0,.6)}#status{font-size:26px;height:30px;margin-top:10px}#hint{margin-top:20px;color:#aaa}#chest{width:180px;height:180px;margin:20px auto;background:radial-gradient(circle at 50% 40%,#444,#222);border-radius:50%;position:relative;box-shadow:inset 0 0 20px rgba(0,0,0,.6)}#sternum{position:absolute;width:60px;height:120px;left:50%;top:50%;transform:translate(-50%,-50%) scaleY(1);background:#bbb;border-radius:20px;transition:transform .08s ease-out,background .08s}.press-perfect{transform:translate(-50%,-50%) scaleY(.6);background:#0f8}.press-good{transform:translate(-50%,-50%) scaleY(.75);background:#ffd000}.press-miss{transform:translate(-50%,-50%) scaleY(.9);background:#f44}#hands{left:50%;top:50%;transform:translate(-50%,-60%);pointer-events:none}#hands,.hand{position:absolute}.hand{width:70px;height:40px;background:linear-gradient(#f1c27d,#d8a25f);border-radius:12px;box-shadow:0 4px 8px rgba(0,0,0,.4);transition:transform .08s ease-out}.hand.left{left:-60px;transform:rotate(-10deg)}.hand.right{left:-10px;transform:rotate(10deg)}#timingUI{position:relative;width:220px;height:320px;margin:30px auto;background:linear-gradient(#1a1a1a,#111);border-radius:16px;box-shadow:inset 0 0 30px rgba(0,0,0,.6);overflow:hidden}#hitLine{bottom:72px;height:4px;background:#fff;box-shadow:0 0 8px #fff}#hitLine,.zone{position:absolute;left:0;width:100%}.zone{pointer-events:none}.zone.perfect{bottom:60px;height:30px;background:rgba(0,255,120,.6)}.zone.good{bottom:50px;height:60px;background:rgba(255,200,0,.3)}#beatMarker{position:absolute;width:100%;height:6px;background:#fff;border-radius:3px;top:0;box-shadow:0 0 10px hsla(0,0%,100%,.7)}</style></head><body><div id="timer">Нажми SPACE для старта</div><div id="timingUI"><div id="hitLine"></div><div class="zone perfect"></div><div class="zone good"></div><div id="beatMarker"></div></div><div id="chest"><div id="sternum"></div><div id="hands"><div class="hand left"></div><div class="hand right"></div></div></div><div id="status"></div><div id="hint">Нажимай SPACE в ритм СЛР</div><script>const GAME_DURATION=10,BPM=100,PERFECT_WINDOW=100,GOOD_WINDOW=200,BEAT_INTERVAL=600;let running=!1,startTime=0,beats=[],perfectHits=0,goodHits=0,totalBeats=0,beatCount=0,hitRegisteredThisBeat=!1;const timerEl=document.getElementById("timer"),statusEl=document.getElementById("status"),sternum=document.getElementById("sternum"),hands=document.getElementById("hands"),beatMarker=document.getElementById("beatMarker"),timingUI=document.getElementById("timingUI"),hitLine=document.getElementById("hitLine");function animatePress(t){sternum.style.transition="none",hands.style.transition="none",sternum.style.transform="translate(-50%, -50%) scaleY(1)",sternum.style.background="#bbb",hands.style.transform="translate(-50%, -60%) translateY(0px)",sternum.offsetHeight,sternum.style.transition="transform 0.08s ease-out, background 0.08s",hands.style.transition="transform 0.08s ease-out";let e=0,n="#bbb";"perfect"===t?(e=18,n="#00ff88"):"good"===t?(e=12,n="#ffd000"):(e=6,n="#ff4444"),sternum.style.transform=`translate(-50%, -50%) scaleY(${1-e/40})`,sternum.style.background=n,hands.style.transform=`translate(-50%, -60%) translateY(${e}px)`,setTimeout((()=>{sternum.style.transform="translate(-50%, -50%) scaleY(1)",sternum.style.background="#bbb",hands.style.transform="translate(-50%, -60%) translateY(0px)"}),120)}function startGame(){running=!0,startTime=performance.now(),perfectHits=0,goodHits=0,beatCount=0,hitRegisteredThisBeat=!1,totalBeats=Math.floor(1e3*GAME_DURATION/BEAT_INTERVAL),update(),runTimer(),runBeatLoop()}function runTimer(){const t=setInterval((()=>{let e=(performance.now()-startTime)/1e3,n=Math.max(0,GAME_DURATION-e).toFixed(1);timerEl.textContent=n+" сек",e>=GAME_DURATION&&(clearInterval(t),endGame())}),50)}function update(){if(!running)return;const t=(performance.now()-startTime)%BEAT_INTERVAL/BEAT_INTERVAL,e=beatMarker.offsetHeight,n=-e/2,s=n+(timingUI.clientHeight+10-e/2-n)*t;beatMarker.style.top=s+"px",requestAnimationFrame(update)}function beatFeedback(){hitLine.classList.add("flash"),timingUI.classList.add("pulse"),setTimeout((()=>{hitLine.classList.remove("flash"),timingUI.classList.remove("pulse")}),120)}function runBeatLoop(){let t=-1;!function e(){if(!running)return;let n=performance.now()-startTime,s=Math.floor(n/BEAT_INTERVAL);s!==t&&(t=s,beatCount++,hitRegisteredThisBeat=!1,beatFeedback()),requestAnimationFrame(e)}()}function handleHit(){if(!running)return;if(hitRegisteredThisBeat)return;hitRegisteredThisBeat=!0;const t=beatMarker.getBoundingClientRect(),e=hitLine.getBoundingClientRect(),n=t.top+t.height/2,s=e.top+e.height/2,a=Math.abs(n-s);return a<=15?(perfectHits++,statusEl.textContent="ОТЛИЧНО",statusEl.style.color="#00ff88",void animatePress("perfect")):a<=30?(goodHits++,statusEl.textContent="ХОРОШО",statusEl.style.color="#ffd000",void animatePress("good")):(statusEl.textContent="МИМО",statusEl.style.color="#ff4444",void animatePress("miss"))}function endGame(){running=!1,0===beatCount&&(beatCount=1);const t=(perfectHits+.5*goodHits)/beatCount*100,e=Math.round(t);timerEl.textContent="Готово!",statusEl.textContent="Точность СЛР: "+e+"%",gmod.OnWin(e)}document.addEventListener("keydown",(t=>{"Space"===t.code&&(t.preventDefault(),running||0!==startTime?handleHit():startGame())}));</script></body></html>
